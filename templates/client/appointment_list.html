{% extends 'base.html' %}
{% load static %}

{% block title %}My Appointments | Aetheria{% endblock %}

{% block extra_css %}
<style>

    :root {
        --gradient-primary: linear-gradient(135deg, #6f42c1, #00b4d8);
        --purple: #6f42c1;
        --turquoise: #00b4d8;
        --primary-dark: #2c3e50;
    }

    /* 1. Container Adjustment for Fixed Header */
    .page-container {
        margin-top: 100px; /* Ù…Ø³Ø§ÙØ© Ø¹Ø´Ø§Ù† Ø§Ù„Ù‡ÙŠØ¯Ø± Ù…ÙŠÙƒÙ„Ø´ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
        min-height: 80vh;
    }

    /* 2. Magic Card */
    .magic-card {
        background: #fff;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.06);
        border: 1px solid rgba(0,0,0,0.02);
        transition: transform 0.3s ease;
    }

    /* 3. Medical Table */
    .medical-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 15px; /* Ù…Ø³Ø§ÙØ§Øª Ø¨ÙŠÙ† Ø§Ù„ØµÙÙˆÙ */
    }
    .medical-table thead th {
        border: none;
        color: #8898aa;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.8rem;
        letter-spacing: 1px;
        padding: 0 20px 10px 20px;
    }
    .medical-table tbody tr {
        background-color: #fff;
        box-shadow: 0 5px 20px rgba(0,0,0,0.03);
        transition: all 0.2s ease;
    }
    .medical-table tbody tr:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.06);
    }
    .medical-table td {
        padding: 20px;
        vertical-align: middle;
        border: 1px solid #f9f9f9;
        color: #525f7f;
    }
    /* ØªØ¯ÙˆÙŠØ± Ø­ÙˆØ§Ù Ø§Ù„ØµÙÙˆÙ */
    .medical-table td:first-child { border-top-left-radius: 15px; border-bottom-left-radius: 15px; border-left: 1px solid #f0f0f0; }
    .medical-table td:last-child { border-top-right-radius: 15px; border-bottom-right-radius: 15px; border-right: 1px solid #f0f0f0; }

    /* 4. Buttons */
    .btn-gradient {
        background: var(--gradient-primary);
        color: white !important;
        border: none;
        border-radius: 50px;
        padding: 12px 30px;
        font-weight: 600;
        transition: 0.3s;
        box-shadow: 0 4px 15px rgba(111, 66, 193, 0.3);
        text-decoration: none;
        display: inline-flex;
        align-items: center;
    }
    .btn-gradient:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(111, 66, 193, 0.5);
        color: white !important;
    }

    .btn-outline-dark {
        border: 2px solid #2c3e50;
        color: #2c3e50;
        border-radius: 50px;
        padding: 10px 25px;
        font-weight: 600;
        transition: 0.3s;
    }
    .btn-outline-dark:hover {
        background: #2c3e50;
        color: white;
    }

    /* 5. Typography & Badges */
    .text-accent {
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 800;
    }
    
    .badge {
        padding: 8px 12px;
        border-radius: 30px;
        font-weight: 600;
        letter-spacing: 0.5px;
    }
    .bg-success { background-color: #d1fae5 !important; color: #065f46; }
    .bg-danger { background-color: #fee2e2 !important; color: #991b1b; }
    .bg-primary { background-color: #e0f2fe !important; color: #075985; }

    /* Animation */
    .animate-fade-in { animation: fadeIn 0.8s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
</style>
{% endblock %}

{% block content %}
<div class="container py-5 animate-fade-in page-container">
    
    <div class="row mb-5 align-items-center">
        <div class="col-md-6">
            <h1 class="display-5 fw-bold text-dark">
                My <span class="text-accent">Appointments</span>
            </h1>
            <p class="lead text-muted">Manage your scheduled visits and history.</p>
        </div>
        <div class="col-md-6 text-md-end">
            <div class="d-flex gap-2 justify-content-md-end flex-wrap">
                <a href="{% url 'book-appointment' %}" class="btn-gradient">
                    <i class="fas fa-plus-circle me-2"></i>Book New
                </a>
                <a href="{% url 'client-portal' %}" class="btn btn-outline-dark">
                    <i class="fas fa-columns me-2"></i>Dashboard
                </a>
            </div>
        </div>
    </div>

    <div class="magic-card">
        {% if appointments %}
        <div class="table-responsive">
            <table class="medical-table">
                <thead>
                    <tr>
                        <th>Doctor</th>
                        <th>Date & Time</th>
                        <th>Reason</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for appt in appointments %}
                    <tr>
                        <td>
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle bg-light d-flex align-items-center justify-content-center me-3 text-secondary fw-bold" 
                                     style="width: 45px; height: 45px; font-size: 1.2rem;">
                                    ğŸ‘¨â€âš•ï¸
                                </div>
                                <div>
                                    <strong class="d-block text-dark">Dr. {{ appt.doctor.name }}</strong>
                                    <small class="text-muted">{{ appt.doctor.specialty }}</small>
                                </div>
                            </div>
                        </td>
                        <td class="fw-bold text-secondary">{{ appt.date_time|date:"M j, Y, g:i A" }}</td>
                        <td>{{ appt.reason|default:"Regular Checkup" }}</td>
                        <td>
                            {% if appt.status == 'Completed' %}
                                <span class="badge bg-success">Completed</span>
                            {% elif appt.status == 'Cancelled' %}
                                <span class="badge bg-danger">Cancelled</span>
                            {% else %}
                                <span class="badge bg-primary">Scheduled</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'appointment-detail' appt.pk %}" class="btn btn-sm btn-light text-muted border rounded-pill px-3 hover-shadow">
                                <i class="fas fa-eye me-1"></i> Details
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="text-center py-5">
            <div class="mb-4 opacity-25">
                <i class="far fa-calendar-times fa-5x text-secondary"></i>
            </div>
            <h4 class="text-muted fw-bold">No appointments found</h4>
            <p class="text-muted mb-4">You haven't scheduled any visits yet.</p>
            <a href="{% url 'book-appointment' %}" class="btn-gradient px-4">
                Book Your First Appointment
            </a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}